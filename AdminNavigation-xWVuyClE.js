import{r as n,s as m,j as e,k as I}from"./index-BZafi1pq.js";import{C as S}from"./check-circle-D4RSxU1c.js";import{A}from"./alert-circle-CxEUEL6T.js";import{A as E}from"./arrow-down-Coe_mpOE.js";import{T as M}from"./trash-u1tdhSct.js";import{P as z}from"./plus-CkoI7QzG.js";import{R as F}from"./refresh-cw-Dg1d389B.js";import{S as L}from"./save-q5_rBzhe.js";const W=()=>{const[w,x]=n.useState(!0),[g,f]=n.useState(!1),[r,o]=n.useState([]),[l,p]=n.useState({label:"",url:""}),[c,b]=n.useState({show:!1,type:"",message:""});n.useEffect(()=>{y()},[]);const y=async()=>{try{x(!0);const{data:s,error:t}=await m.from("navigation_items").select("*").order("display_order",{ascending:!0});if(t)throw t;o(s||[])}catch(s){console.error("Error fetching navigation:",s),d("error","Failed to load navigation menu")}finally{x(!1)}},v=s=>{if(s===0)return;const t=[...r],a=t[s];t[s]=t[s-1],t[s-1]=a,t[s].display_order=s,t[s-1].display_order=s-1,o(t)},N=s=>{if(s===r.length-1)return;const t=[...r],a=t[s];t[s]=t[s+1],t[s+1]=a,t[s].display_order=s,t[s+1].display_order=s+1,o(t)},u=(s,t,a)=>{const i=[...r];i[s][t]=a,o(i)},j=s=>{if(confirm("Are you sure you want to delete this navigation item?")){const t=[...r],a=t.splice(s,1)[0];t.forEach((i,h)=>{i.display_order=h}),o(t),a.id&&_(a.id)}},_=async s=>{try{const{error:t}=await m.from("navigation_items").delete().eq("id",s);if(t)throw t}catch(t){console.error("Error deleting navigation item:",t),d("error","Failed to delete navigation item")}},k=()=>{if(!l.label.trim()||!l.url.trim()){d("error","Please fill out both label and URL");return}const s=[...r,{label:l.label,url:l.url,display_order:r.length,is_active:!0}];o(s),p({label:"",url:""})},C=async s=>{s.preventDefault(),f(!0);try{const{error:t}=await m.from("navigation_items").delete().gte("id",0);if(t)throw t;const{error:a}=await m.from("navigation_items").insert(r.map((i,h)=>({label:i.label,url:i.url,display_order:h,is_active:i.is_active!==!1})));if(a)throw a;d("success","Navigation menu saved successfully"),y()}catch(t){console.error("Error saving navigation menu:",t),d("error","Failed to save navigation menu")}finally{f(!1)}},d=(s,t)=>{b({show:!0,type:s,message:t}),setTimeout(()=>{b({show:!1,type:"",message:""})},5e3)};return w?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-yellow-400"})}):e.jsxs("div",{className:"h-full",children:[c.show&&e.jsxs("div",{className:`fixed top-6 right-6 z-50 p-4 rounded-md shadow-lg flex items-start ${c.type==="success"?"bg-green-500/20 border border-green-500/30 text-green-400":c.type==="error"?"bg-red-500/20 border border-red-500/30 text-red-400":"bg-blue-500/20 border border-blue-500/30 text-blue-400"}`,children:[c.type==="success"?e.jsx(S,{size:18,className:"mr-3 mt-0.5 flex-shrink-0"}):e.jsx(A,{size:18,className:"mr-3 mt-0.5 flex-shrink-0"}),e.jsx("p",{children:c.message})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-serif text-white mb-2",children:"Navigation Menu Management"}),e.jsx("p",{className:"text-gray-400",children:"Edit and rearrange items in your website's main navigation menu."})]}),e.jsxs("form",{onSubmit:C,children:[e.jsxs("div",{className:"bg-slate-800 rounded-lg shadow-lg p-6 mb-8",children:[e.jsx("h2",{className:"text-xl font-medium text-white mb-6",children:"Main Navigation"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-700",children:[e.jsx("thead",{className:"bg-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Label"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"URL / Path"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Order"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),e.jsxs("tbody",{className:"bg-slate-800 divide-y divide-gray-700",children:[r.map((s,t)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("input",{type:"text",value:s.label,onChange:a=>u(t,"label",a.target.value),className:"w-full px-3 py-1 bg-slate-700 border border-slate-600 rounded focus:outline-none focus:ring-2 focus:ring-yellow-400 text-white",placeholder:"Menu Label",required:!0})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("input",{type:"text",value:s.url,onChange:a=>u(t,"url",a.target.value),className:"w-full px-3 py-1 bg-slate-700 border border-slate-600 rounded focus:outline-none focus:ring-2 focus:ring-yellow-400 text-white",placeholder:"/page-path",required:!0})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:`is_active_${t}`,checked:s.is_active!==!1,onChange:a=>u(t,"is_active",a.target.checked),className:"mr-2"}),e.jsx("label",{htmlFor:`is_active_${t}`,className:"text-gray-300 text-sm",children:"Active"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("button",{type:"button",onClick:()=>v(t),disabled:t===0,className:"p-1 text-gray-400 hover:text-white disabled:opacity-30 disabled:cursor-not-allowed",title:"Move up",children:e.jsx(I,{size:16})}),e.jsx("button",{type:"button",onClick:()=>N(t),disabled:t===r.length-1,className:"p-1 text-gray-400 hover:text-white disabled:opacity-30 disabled:cursor-not-allowed",title:"Move down",children:e.jsx(E,{size:16})})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:e.jsx("button",{type:"button",onClick:()=>j(t),className:"text-red-400 hover:text-red-300",title:"Delete",children:e.jsx(M,{size:18})})})]},t)),e.jsxs("tr",{className:"bg-slate-700/30",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("input",{type:"text",value:l.label,onChange:s=>p({...l,label:s.target.value}),className:"w-full px-3 py-1 bg-slate-700 border border-slate-600 rounded focus:outline-none focus:ring-2 focus:ring-yellow-400 text-white",placeholder:"New Menu Label"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("input",{type:"text",value:l.url,onChange:s=>p({...l,url:s.target.value}),className:"w-full px-3 py-1 bg-slate-700 border border-slate-600 rounded focus:outline-none focus:ring-2 focus:ring-yellow-400 text-white",placeholder:"/page-path"})}),e.jsx("td",{colSpan:2,className:"px-6 py-4",children:e.jsx("span",{className:"text-gray-400 text-sm",children:"Will be added to the end"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:e.jsxs("button",{type:"button",onClick:k,className:"px-3 py-1 bg-green-500/20 text-green-400 rounded hover:bg-green-500/30 transition-colors flex items-center ml-auto",children:[e.jsx(z,{size:16,className:"mr-1"}),"Add"]})})]})]})]})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",disabled:g,className:"px-6 py-3 bg-yellow-400 text-slate-900 rounded-sm hover:bg-yellow-500 transition-colors flex items-center font-medium disabled:opacity-70",children:g?e.jsxs(e.Fragment,{children:[e.jsx(F,{size:18,className:"mr-2 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(L,{size:18,className:"mr-2"}),"Save Navigation Menu"]})})})]})]})};export{W as default};
