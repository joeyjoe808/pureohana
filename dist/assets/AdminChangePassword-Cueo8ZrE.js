import{c as E,r as i,j as e,X as M,A as $,s as w}from"./index-D4gBdtZF.js";import{R as A}from"./refresh-cw-kYokf9fA.js";import{C as V}from"./check-DJ6ce73g.js";import{C as R}from"./check-circle-fnKANasE.js";import{E as C}from"./eye-C-7k4V01.js";import{S as q}from"./save-CfxmEbD6.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=E("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);var m=(t=>(t.VeryWeak="Very Weak",t.Weak="Weak",t.Moderate="Moderate",t.Strong="Strong",t.VeryStrong="Very Strong",t))(m||{});const G={"Very Weak":"bg-red-500",Weak:"bg-orange-500",Moderate:"bg-yellow-500",Strong:"bg-green-400","Very Strong":"bg-green-600"},U=t=>{const a={strength:"Very Weak",score:0,feedback:[]};if(!t)return a.feedback.push("Please enter a password."),a;const s=[];let r=0;t.length<8?s.push("Password should be at least 8 characters long."):r+=t.length>12?25:15;const l=/[A-Z]/.test(t),c=/[a-z]/.test(t),n=/\d/.test(t),h=/[!@#$%^&*(),.?":{}|<>]/.test(t);return l?r+=10:s.push("Add uppercase letters for stronger security."),c?r+=10:s.push("Add lowercase letters for better security."),n?r+=10:s.push("Add numbers to strengthen your password."),h?r+=15:s.push("Add special characters (!@#$%^&*) for maximum security."),["123456","123123","111111","000000","qwerty","password","admin"].some(f=>t.toLowerCase().includes(f))&&(s.push('Avoid common patterns like "123456" or "password".'),r-=20),/(.)\1{2,}/.test(t)&&(s.push("Avoid repeating the same character more than twice."),r-=10),r=Math.max(0,r),r>=60?(a.strength="Very Strong",s.length===0&&s.push("Excellent password choice!")):r>=45?a.strength="Strong":r>=30?a.strength="Moderate":r>=15?a.strength="Weak":a.strength="Very Weak",r>=45&&s.length===0&&s.push("Good job! Your password meets security recommendations."),a.score=r,a.feedback=s,a},Z=()=>{const a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()";let s="";for(let r=0;r<12;r++){const l=Math.floor(Math.random()*a.length);s+=a[l]}return/[A-Z]/.test(s)||(s=g(s,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")),/[a-z]/.test(s)||(s=g(s,"abcdefghijklmnopqrstuvwxyz")),/\d/.test(s)||(s=g(s,"0123456789")),/[!@#$%^&*()]/.test(s)||(s=g(s,"!@#$%^&*()")),s},g=(t,a)=>{const s=Math.floor(Math.random()*t.length),r=a[Math.floor(Math.random()*a.length)];return t.substring(0,s)+r+t.substring(s+1)},F=({password:t,showGenerateOption:a=!1,onGeneratePassword:s})=>{const[r,l]=i.useState({strength:m.VeryWeak,score:0,feedback:["Enter a password to see strength feedback."]});i.useEffect(()=>{l(t?U(t):{strength:m.VeryWeak,score:0,feedback:["Enter a password to see strength feedback."]})},[t]);const c=()=>{if(s){const n=Z();s(n)}};return e.jsxs("div",{className:"mt-2 mb-4",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("div",{className:"flex-grow flex h-2 bg-slate-700 rounded overflow-hidden",children:[1,2,3,4].map(n=>e.jsx("div",{className:`h-full flex-1 ${r.score>=n*20?G[r.strength]:"bg-slate-700"}`},n))}),a&&e.jsxs("button",{type:"button",onClick:c,className:"ml-3 text-xs text-yellow-400 hover:text-yellow-300 flex items-center",children:[e.jsx(A,{size:12,className:"mr-1"}),"Generate"]})]}),e.jsxs("div",{className:"text-xs",children:[e.jsxs("div",{className:"flex items-center text-gray-400",children:[e.jsx("span",{className:"font-medium mr-2",children:"Strength:"}),e.jsx("span",{className:`
            ${r.strength===m.VeryWeak||r.strength===m.Weak?"text-red-400":r.strength===m.Moderate?"text-yellow-400":"text-green-400"}`,children:r.strength})]}),e.jsx("ul",{className:"mt-2 space-y-1",children:r.feedback.map((n,h)=>e.jsxs("li",{className:"flex items-start",children:[n.startsWith("Add")||n.startsWith("Avoid")||n.startsWith("Password should")?e.jsx(M,{size:12,className:"text-red-400 mr-1.5 mt-0.5 flex-shrink-0"}):e.jsx(V,{size:12,className:"text-green-400 mr-1.5 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-gray-400",children:n})]},h))})]})]})},I=t=>t?t.length<8?{valid:!1,message:"Password must be at least 8 characters long"}:/[A-Z]/.test(t)?/\d/.test(t)?/[!@#$%^&*(),.?":{}|<>]/.test(t)?{valid:!0,message:"Password is strong"}:{valid:!1,message:"Password must contain at least one special character"}:{valid:!1,message:"Password must contain at least one number"}:{valid:!1,message:"Password must contain at least one uppercase letter"}:{valid:!1,message:"Password is required"},B=()=>{const[t,a]=i.useState(""),[s,r]=i.useState(""),[l,c]=i.useState(""),[n,h]=i.useState(!1),[u,f]=i.useState(!1),[p,b]=i.useState(!1),[j,d]=i.useState(""),[y,N]=i.useState(""),z=o=>{r(o),c(o)},W=async o=>{var k;if(o.preventDefault(),d(""),N(""),!t){d("Please enter your current password.");return}if(!s){d("Please enter a new password.");return}if(s!==l){d("New password and confirmation do not match.");return}const v=I(s);if(!v.valid){d(v.message);return}b(!0);try{const{error:x}=await w.auth.signInWithPassword({email:((k=(await w.auth.getUser()).data.user)==null?void 0:k.email)||"",password:t});if(x)throw new Error("Current password is incorrect.");const{error:P}=await w.auth.updateUser({password:s});if(P)throw P;N("Password updated successfully."),a(""),r(""),c("")}catch(x){d(x.message||"Failed to update password."),console.error("Password update error:",x)}finally{b(!1)}};return e.jsxs("div",{className:"max-w-xl mx-auto",children:[e.jsx("h2",{className:"text-xl font-medium text-white mb-6",children:"Change Password"}),j&&e.jsxs("div",{className:"mb-6 bg-red-500/10 border border-red-500/30 rounded-md p-4 flex items-start",children:[e.jsx($,{size:18,className:"text-red-400 mr-3 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-sm text-red-300",children:j})]}),y&&e.jsxs("div",{className:"mb-6 bg-green-500/10 border border-green-500/30 rounded-md p-4 flex items-start",children:[e.jsx(R,{size:18,className:"text-green-400 mr-3 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-sm text-green-300",children:y})]}),e.jsx("form",{onSubmit:W,className:"bg-slate-800 rounded-lg p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-300 mb-2",children:"Current Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:n?"text":"password",value:t,onChange:o=>a(o.target.value),className:"w-full px-4 py-2 pr-10 bg-slate-700 border border-slate-600 rounded focus:outline-none focus:ring-2 focus:ring-yellow-400 text-white",placeholder:"Enter your current password"}),e.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-white",onClick:()=>h(!n),children:n?e.jsx(S,{size:18}):e.jsx(C,{size:18})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-300 mb-2",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:u?"text":"password",value:s,onChange:o=>r(o.target.value),className:"w-full px-4 py-2 pr-10 bg-slate-700 border border-slate-600 rounded focus:outline-none focus:ring-2 focus:ring-yellow-400 text-white",placeholder:"Enter new password"}),e.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-white",onClick:()=>f(!u),children:u?e.jsx(S,{size:18}):e.jsx(C,{size:18})})]}),e.jsx(F,{password:s,showGenerateOption:!0,onGeneratePassword:z})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-300 mb-2",children:"Confirm New Password"}),e.jsx("input",{type:"password",value:l,onChange:o=>c(o.target.value),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded focus:outline-none focus:ring-2 focus:ring-yellow-400 text-white",placeholder:"Confirm new password"}),l&&s!==l&&e.jsx("p",{className:"mt-1 text-sm text-red-400",children:"Passwords do not match"})]}),e.jsxs("div",{className:"bg-slate-700/50 p-4 rounded-md text-sm",children:[e.jsx("h3",{className:"text-white font-medium mb-2",children:"Password Requirements:"}),e.jsxs("ul",{className:"space-y-1 text-gray-300",children:[e.jsxs("li",{className:"flex items-center",children:[e.jsx("div",{className:`w-4 h-4 rounded-full mr-2 flex items-center justify-center ${s.length>=8?"bg-green-500":"bg-slate-600"}`,children:s.length>=8&&e.jsx(Check,{size:10,className:"text-white"})}),"At least 8 characters long"]}),e.jsxs("li",{className:"flex items-center",children:[e.jsx("div",{className:`w-4 h-4 rounded-full mr-2 flex items-center justify-center ${/[A-Z]/.test(s)?"bg-green-500":"bg-slate-600"}`,children:/[A-Z]/.test(s)&&e.jsx(Check,{size:10,className:"text-white"})}),"Contains uppercase letters"]}),e.jsxs("li",{className:"flex items-center",children:[e.jsx("div",{className:`w-4 h-4 rounded-full mr-2 flex items-center justify-center ${/\d/.test(s)?"bg-green-500":"bg-slate-600"}`,children:/\d/.test(s)&&e.jsx(Check,{size:10,className:"text-white"})}),"Contains numbers"]}),e.jsxs("li",{className:"flex items-center",children:[e.jsx("div",{className:`w-4 h-4 rounded-full mr-2 flex items-center justify-center ${/[!@#$%^&*(),.?":{}|<>]/.test(s)?"bg-green-500":"bg-slate-600"}`,children:/[!@#$%^&*(),.?":{}|<>]/.test(s)&&e.jsx(Check,{size:10,className:"text-white"})}),"Contains special characters"]})]})]}),e.jsx("button",{type:"submit",disabled:p||!t||!s||s!==l,className:"w-full px-4 py-2 bg-yellow-400 text-slate-900 rounded hover:bg-yellow-500 transition-colors flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed",children:p?e.jsxs(e.Fragment,{children:[e.jsx(A,{size:18,className:"mr-2 animate-spin"}),"Updating Password..."]}):e.jsxs(e.Fragment,{children:[e.jsx(q,{size:18,className:"mr-2"}),"Update Password"]})})]})}),e.jsx("div",{className:"mt-4 text-sm text-gray-500",children:e.jsx("p",{children:"For security reasons, you'll be required to sign in again after changing your password."})})]})};export{B as default};
