import{c as D,r as i,s as f,j as e,S as q,F as C,E as A,i as P}from"./index-B4Le2Hq4.js";import{F as R}from"./FileUploader-7rv24HJz.js";import{C as B}from"./check-circle-D49wV4nZ.js";import{A as W}from"./alert-circle-aCKoEi-Z.js";import{R as $}from"./refresh-cw-5i_ftdaB.js";import{F as G}from"./film-CzOvQyKE.js";import{S as V}from"./save-BRFa-UTm.js";import{S as O}from"./square-pen-BS9gUzb7.js";import{T as Q}from"./trash-2-B9c2TZ5w.js";import"./upload-CvNSoRrn.js";import"./check-D-StGsGd.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=D("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),ie=()=>{const[F,o]=i.useState(!0),[c,y]=i.useState([]),[g,h]=i.useState([]),[S,b]=i.useState(!1),[n,N]=i.useState(""),[x,v]=i.useState("all"),[u,w]=i.useState({show:!1,type:"",message:""}),[t,j]=i.useState(null),[a,m]=i.useState(null);i.useEffect(()=>{_()},[]),i.useEffect(()=>{n||x!=="all"?M():h(c)},[n,x,c]);const _=async()=>{try{o(!0);const{data:s,error:l}=await f.from("media_library").select("*").order("created_at",{ascending:!1});if(l)throw l;y(s||[]),h(s||[])}catch(s){console.error("Error fetching media library:",s),d("error","Failed to load media library")}finally{o(!1)}},M=()=>{let s=[...c];if(n){const l=n.toLowerCase();s=s.filter(r=>r.file_name&&r.file_name.toLowerCase().includes(l)||r.title&&r.title.toLowerCase().includes(l)||r.description&&r.description.toLowerCase().includes(l))}x!=="all"&&(s=s.filter(l=>l.file_type&&l.file_type.startsWith(x))),h(s)},k=async s=>{try{b(!0),_(),d("success","File uploaded successfully")}catch(l){console.error("Error handling upload:",l),d("error","Failed to process uploaded file")}finally{b(!1)}},z=async s=>{if(confirm("Are you sure you want to delete this media item? This cannot be undone."))try{o(!0);const{data:l}=await f.from("media_library").select("file_path").eq("id",s).single();if(l){const p=l.file_path.split("/").pop();try{await f.storage.from("media").remove([`media_library/${p}`])}catch(U){console.error("Error deleting from storage (continuing):",U)}}const{error:r}=await f.from("media_library").delete().eq("id",s);if(r)throw r;y(c.filter(p=>p.id!==s)),h(g.filter(p=>p.id!==s)),t&&t.id===s&&j(null),d("success","Media deleted successfully")}catch(l){console.error("Error deleting media:",l),d("error","Failed to delete media")}finally{o(!1)}},T=async()=>{if(a)try{o(!0);const{error:s}=await f.from("media_library").update({title:a.title,alt_text:a.alt_text,description:a.description,updated_at:new Date().toISOString()}).eq("id",a.id);if(s)throw s;y(c.map(l=>l.id===a.id?{...l,...a}:l)),h(g.map(l=>l.id===a.id?{...l,...a}:l)),j({...t,...a}),m(null),d("success","Media updated successfully")}catch(s){console.error("Error updating media:",s),d("error","Failed to update media")}finally{o(!1)}},I=s=>{m({...s})},E=s=>{navigator.clipboard.writeText(s).then(()=>d("success","URL copied to clipboard"),()=>d("error","Failed to copy URL"))},L=s=>{if(!s)return"Unknown";const l=["Bytes","KB","MB","GB"],r=Math.floor(Math.log(s)/Math.log(1024));return`${parseFloat((s/Math.pow(1024,r)).toFixed(2))} ${l[r]}`},d=(s,l)=>{w({show:!0,type:s,message:l}),setTimeout(()=>{w({show:!1,type:"",message:""})},5e3)};return F&&c.length===0?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-yellow-400"})}):e.jsxs("div",{className:"h-full",children:[u.show&&e.jsxs("div",{className:`fixed top-6 right-6 z-50 p-4 rounded-md shadow-lg flex items-start ${u.type==="success"?"bg-green-500/20 border border-green-500/30 text-green-400":u.type==="error"?"bg-red-500/20 border border-red-500/30 text-red-400":"bg-blue-500/20 border border-blue-500/30 text-blue-400"}`,children:[u.type==="success"?e.jsx(B,{size:18,className:"mr-3 mt-0.5 flex-shrink-0"}):e.jsx(W,{size:18,className:"mr-3 mt-0.5 flex-shrink-0"}),e.jsx("p",{children:u.message})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-serif text-white mb-2",children:"Media Library"}),e.jsx("p",{className:"text-gray-400",children:"Manage all your media files in one place."})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-slate-800 rounded-lg shadow-lg p-6 mb-8",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6 gap-4",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Search media...",value:n,onChange:s=>N(s.target.value),className:"w-full px-4 py-2 pl-10 bg-slate-700 border border-slate-600 rounded focus:outline-none focus:ring-2 focus:ring-yellow-400 text-white"}),e.jsx(q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16})]}),e.jsxs("select",{value:x,onChange:s=>v(s.target.value),className:"px-4 py-2 bg-slate-700 border border-slate-600 rounded focus:outline-none focus:ring-2 focus:ring-yellow-400 text-white",children:[e.jsx("option",{value:"all",children:"All Media"}),e.jsx("option",{value:"image",children:"Images"}),e.jsx("option",{value:"video",children:"Videos"}),e.jsx("option",{value:"application",children:"Documents"})]})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-medium text-white mb-4",children:"Upload New Media"}),e.jsx(R,{folder:"media_library",fileTypes:["image/*","video/*","application/pdf"],maxSizeMB:50,onUploadComplete:k,buttonText:"Upload Media File",placeholder:"JPG, PNG, GIF, MP4, PDF, etc. (Max 50MB)",showPreview:!1})]}),S&&e.jsxs("div",{className:"flex justify-center items-center py-4 mb-4 bg-slate-700/30 rounded",children:[e.jsx($,{size:20,className:"animate-spin text-yellow-400 mr-2"}),e.jsx("span",{className:"text-white",children:"Processing upload..."})]}),g.length===0?e.jsx("div",{className:"text-center py-12",children:n||x!=="all"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-5xl mb-4",children:"ðŸ”"}),e.jsx("h2",{className:"text-xl text-white mb-2",children:"No results found"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"Try adjusting your search terms or filters."}),e.jsx("button",{onClick:()=>{N(""),v("all")},className:"px-4 py-2 bg-slate-700 text-white rounded hover:bg-slate-600 transition-colors",children:"Clear filters"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-5xl mb-4",children:"ðŸ“"}),e.jsx("h2",{className:"text-xl text-white mb-2",children:"Your media library is empty"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"Upload files to add them to your media library."})]})}):e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:g.map(s=>e.jsxs("div",{onClick:()=>j(s),className:`relative group cursor-pointer rounded-md overflow-hidden bg-slate-700 ${t&&t.id===s.id?"ring-2 ring-yellow-400":""}`,children:[s.file_type&&s.file_type.startsWith("image/")?e.jsx("div",{className:"aspect-square",children:e.jsx("img",{src:s.file_path,alt:s.alt_text||s.file_name,className:"w-full h-full object-cover"})}):s.file_type&&s.file_type.startsWith("video/")?e.jsxs("div",{className:"aspect-square bg-slate-800 flex flex-col items-center justify-center",children:[e.jsx(G,{size:24,className:"text-gray-400 mb-2"}),e.jsx("span",{className:"text-xs text-gray-400",children:"Video"})]}):e.jsxs("div",{className:"aspect-square bg-slate-800 flex flex-col items-center justify-center",children:[e.jsx(C,{size:24,className:"text-gray-400 mb-2"}),e.jsx("span",{className:"text-xs text-gray-400",children:"File"})]}),e.jsx("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 py-1 px-2",children:e.jsx("div",{className:"text-white text-xs truncate",children:s.title||s.file_name})})]},s.id))})]})}),e.jsx("div",{className:"lg:col-span-1",children:t?e.jsx("div",{className:"bg-slate-800 rounded-lg shadow-lg p-6 sticky top-6",children:e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-xl font-medium text-white mb-4",children:"Media Details"}),e.jsx("div",{className:"mb-6",children:t.file_type&&t.file_type.startsWith("image/")?e.jsx("img",{src:t.file_path,alt:t.alt_text||t.file_name,className:"w-full h-auto rounded"}):t.file_type&&t.file_type.startsWith("video/")?e.jsx("div",{className:"aspect-video bg-slate-700 rounded",children:e.jsx("video",{src:t.file_path,controls:!0,className:"w-full h-full rounded"})}):e.jsx("div",{className:"aspect-video bg-slate-700 rounded flex items-center justify-center",children:e.jsx(C,{size:40,className:"text-gray-400"})})}),a?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-300 mb-1 text-sm",children:"Title"}),e.jsx("input",{type:"text",value:a.title||"",onChange:s=>m({...a,title:s.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded focus:outline-none focus:ring-2 focus:ring-yellow-400 text-white",placeholder:"Media title"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-300 mb-1 text-sm",children:"Alt Text"}),e.jsx("input",{type:"text",value:a.alt_text||"",onChange:s=>m({...a,alt_text:s.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded focus:outline-none focus:ring-2 focus:ring-yellow-400 text-white",placeholder:"Alternative text for accessibility"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-300 mb-1 text-sm",children:"Description"}),e.jsx("textarea",{value:a.description||"",onChange:s=>m({...a,description:s.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded focus:outline-none focus:ring-2 focus:ring-yellow-400 text-white",placeholder:"Media description",rows:3})]}),e.jsxs("div",{className:"flex space-x-3 pt-2",children:[e.jsx("button",{type:"button",onClick:()=>m(null),className:"px-3 py-1 border border-gray-600 rounded text-gray-300 hover:bg-gray-700 transition-colors",children:"Cancel"}),e.jsxs("button",{type:"button",onClick:T,className:"px-3 py-1 bg-yellow-400 text-slate-900 rounded hover:bg-yellow-500 transition-colors flex items-center",children:[e.jsx(V,{size:16,className:"mr-1"}),"Save Changes"]})]})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-300 text-sm font-medium",children:"File Name"}),e.jsx("p",{className:"text-white break-words",children:t.file_name})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-300 text-sm font-medium",children:"Type"}),e.jsx("p",{className:"text-white",children:t.file_type})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-300 text-sm font-medium",children:"Size"}),e.jsx("p",{className:"text-white",children:L(t.file_size)})]})]}),t.width&&t.height&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-300 text-sm font-medium",children:"Dimensions"}),e.jsxs("p",{className:"text-white",children:[t.width," Ã— ",t.height,"px"]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-300 text-sm font-medium",children:"Title"}),e.jsx("p",{className:"text-white",children:t.title||"â€”"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-300 text-sm font-medium",children:"Alt Text"}),e.jsx("p",{className:"text-white",children:t.alt_text||"â€”"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-300 text-sm font-medium",children:"Description"}),e.jsx("p",{className:"text-white",children:t.description||"â€”"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-300 text-sm font-medium",children:"Uploaded"}),e.jsx("p",{className:"text-white",children:new Date(t.created_at).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-300 text-sm font-medium",children:"URL"}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx("input",{type:"text",value:t.file_path,readOnly:!0,className:"flex-grow px-2 py-1 bg-slate-700 border border-slate-600 rounded-l text-white text-sm truncate"}),e.jsx("button",{onClick:()=>E(t.file_path),className:"px-2 py-1 bg-slate-600 text-white rounded-r",title:"Copy URL",children:e.jsx(J,{size:14})})]})]})]}),e.jsxs("div",{className:"flex space-x-3 mt-6",children:[e.jsxs("button",{type:"button",onClick:()=>I(t),className:"px-3 py-1 border border-blue-500/30 text-blue-400 rounded hover:bg-blue-500/10 transition-colors flex items-center",children:[e.jsx(O,{size:16,className:"mr-1"}),"Edit"]}),e.jsxs("button",{type:"button",onClick:()=>window.open(t.file_path,"_blank"),className:"px-3 py-1 border border-green-500/30 text-green-400 rounded hover:bg-green-500/10 transition-colors flex items-center",children:[e.jsx(A,{size:16,className:"mr-1"}),"View"]}),e.jsxs("button",{type:"button",onClick:()=>z(t.id),className:"px-3 py-1 border border-red-500/30 text-red-400 rounded hover:bg-red-500/10 transition-colors flex items-center",children:[e.jsx(Q,{size:16,className:"mr-1"}),"Delete"]})]})]})]})}):e.jsx("div",{className:"bg-slate-800 rounded-lg shadow-lg p-6",children:e.jsxs("div",{className:"py-10 text-center",children:[e.jsx("div",{className:"mx-auto w-16 h-16 rounded-full bg-slate-700 flex items-center justify-center mb-4",children:e.jsx(P,{size:24,className:"text-gray-400"})}),e.jsx("h2",{className:"text-lg text-white mb-2",children:"No Media Selected"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"Select an item to view its details or upload new media."})]})})})]})]})};export{ie as default};
