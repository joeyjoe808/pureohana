import{c as $,r as x,s as d,j as e,l as z,i as O}from"./index-B4Le2Hq4.js";import{F as V}from"./FileUploader-7rv24HJz.js";import{M as B}from"./MediaUploader-uJzri-CP.js";import{C as Y}from"./check-circle-D49wV4nZ.js";import{A as H}from"./alert-circle-aCKoEi-Z.js";import{P as J}from"./plus-A_0o6xWi.js";import{P as K}from"./plus-circle-tDqTzE5b.js";import{C as Q}from"./chevron-left-B9lQMt5G.js";import{T as F}from"./trash-2-B9c2TZ5w.js";import{R as W}from"./refresh-cw-5i_ftdaB.js";import{S as X}from"./save-BRFa-UTm.js";import{A as Z}from"./arrow-left-RrPi6TEU.js";import{F as D}from"./film-CzOvQyKE.js";import{S as ee}from"./star-_7C8VJaL.js";import"./upload-CvNSoRrn.js";import"./check-D-StGsGd.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=$("Move",[["polyline",{points:"5 9 2 12 5 15",key:"1r5uj5"}],["polyline",{points:"9 5 12 2 15 5",key:"5v383o"}],["polyline",{points:"15 19 12 22 9 19",key:"g7qi8m"}],["polyline",{points:"19 9 22 12 19 15",key:"tpp73q"}],["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}]]),ye=()=>{const[j,i]=x.useState(!0),[y,E]=x.useState([]),[h,c]=x.useState("galleries"),[t,o]=x.useState(null),[u,g]=x.useState([]),[p,C]=x.useState({show:!1,type:"",message:""}),[I,w]=x.useState(!1);x.useEffect(()=>{v()},[]);const v=async()=>{try{i(!0);const{data:s,error:l}=await d.from("galleries").select("*").order("display_order",{ascending:!0});if(l)throw l;E(s||[])}catch(s){console.error("Error fetching galleries:",s),a("error","Failed to load galleries")}finally{i(!1)}},M=async s=>{try{i(!0);const{data:l,error:r}=await d.from("gallery_items").select("*").eq("gallery_id",s).order("display_order",{ascending:!0});if(r)throw r;g(l||[])}catch(l){console.error("Error fetching gallery items:",l),a("error","Failed to load gallery items")}finally{i(!1)}},m=s=>{const{name:l,value:r,type:n,checked:_}=s.target;o(f=>({...f,[l]:n==="checkbox"?_:r}))},q=async s=>{if(s.preventDefault(),!t.title||!t.slug){a("error","Please fill out all required fields");return}try{if(i(!0),t.id){const{error:l}=await d.from("galleries").update({title:t.title,slug:t.slug,description:t.description,cover_image:t.cover_image,is_featured:t.is_featured,is_published:t.is_published,display_order:t.display_order||0,meta_title:t.meta_title,meta_description:t.meta_description,updated_at:new Date().toISOString()}).eq("id",t.id);if(l)throw l;a("success","Gallery updated successfully")}else{const{data:l,error:r}=await d.from("galleries").insert({title:t.title,slug:t.slug,description:t.description,cover_image:t.cover_image,is_featured:t.is_featured,is_published:t.is_published===void 0?!0:t.is_published,display_order:y.length,meta_title:t.meta_title,meta_description:t.meta_description}).select();if(r)throw r;l&&l[0]&&(o(l[0]),a("success","Gallery created successfully"),c("gallery-items"))}v()}catch(l){console.error("Error saving gallery:",l),a("error",`Failed to save gallery: ${l.message}`)}finally{i(!1)}},P=async()=>{if(!(!t||!t.id))try{i(!0),w(!1),await d.from("gallery_items").delete().eq("gallery_id",t.id);const{error:s}=await d.from("galleries").delete().eq("id",t.id);if(s)throw s;a("success","Gallery deleted successfully"),v(),c("galleries"),o(null)}catch(s){console.error("Error deleting gallery:",s),a("error","Failed to delete gallery")}finally{i(!1)}},k=s=>{o(s),c("edit-gallery")},U=s=>{o(s),M(s.id),c("gallery-items")},G=()=>{o({title:"",slug:"",description:"",cover_image:"",is_featured:!1,is_published:!0,display_order:y.length,meta_title:"",meta_description:""}),c("edit-gallery")},A=async s=>{h==="edit-gallery"&&o(l=>({...l,cover_image:s}))},T=async s=>{try{i(!0);const{error:l}=await d.from("gallery_items").delete().eq("id",s);if(l)throw l;g(u.filter(r=>r.id!==s)),a("success","Item deleted successfully")}catch(l){console.error("Error deleting item:",l),a("error","Failed to delete item")}finally{i(!1)}},N=async(s,l)=>{try{const{error:r}=await d.from("gallery_items").update(l).eq("id",s);if(r)throw r;g(u.map(n=>n.id===s?{...n,...l}:n))}catch(r){console.error("Error updating gallery item:",r),a("error","Failed to update gallery item")}},L=async(s,l)=>{try{i(!0);let r=s,n=s,_=l==="video"?s:null;if(l==="video"&&(s.includes("youtube.com")||s.includes("youtu.be"))){let b="";s.includes("youtube.com/watch?v=")?b=new URL(s).searchParams.get("v"):s.includes("youtu.be/")&&(b=s.split("youtu.be/")[1].split("?")[0]),b&&(n=`https://img.youtube.com/vi/${b}/0.jpg`,r=n)}const{data:f,error:S}=await d.from("gallery_items").insert({gallery_id:t.id,media_type:l,file_path:r,thumbnail_path:n,video_url:_,display_order:u.length}).select();if(S)throw S;f&&f[0]&&(g([...u,f[0]]),a("success",`${l.charAt(0).toUpperCase()+l.slice(1)} added successfully`))}catch(r){console.error("Error adding gallery item:",r),a("error","Failed to add item to gallery")}finally{i(!1)}},R=()=>t!=null&&t.title?t.title.toLowerCase().replace(/[^a-z0-9 ]/g,"").replace(/\s+/g,"-"):"",a=(s,l)=>{C({show:!0,type:s,message:l}),setTimeout(()=>{C({show:!1,type:"",message:""})},5e3)};return j&&h==="galleries"?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-yellow-400"})}):e.jsxs("div",{className:"h-full",children:[p.show&&e.jsxs("div",{className:`fixed top-6 right-6 z-50 p-4 rounded-md shadow-lg flex items-start ${p.type==="success"?"bg-green-500/20 border border-green-500/30 text-green-400":p.type==="error"?"bg-red-500/20 border border-red-500/30 text-red-400":"bg-blue-500/20 border border-blue-500/30 text-blue-400"}`,children:[p.type==="success"?e.jsx(Y,{size:18,className:"mr-3 mt-0.5 flex-shrink-0"}):e.jsx(H,{size:18,className:"mr-3 mt-0.5 flex-shrink-0"}),e.jsx("p",{children:p.message})]}),I&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/80",children:e.jsxs("div",{className:"bg-slate-800 p-8 rounded-lg max-w-md w-full",children:[e.jsx("h3",{className:"text-xl font-medium text-white mb-4",children:"Confirm Deletion"}),e.jsxs("p",{className:"text-gray-300 mb-6",children:['Are you sure you want to delete "',t.title,'"? This action cannot be undone and will delete all media items in this gallery.']}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx("button",{onClick:()=>w(!1),className:"px-4 py-2 bg-slate-700 text-white rounded hover:bg-slate-600 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:P,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"Delete Gallery"})]})]})}),h==="galleries"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-serif text-white",children:"Portfolio Galleries"}),e.jsxs("button",{onClick:G,className:"px-4 py-2 bg-yellow-400 text-slate-900 rounded hover:bg-yellow-500 transition-colors flex items-center",children:[e.jsx(J,{size:18,className:"mr-1"}),"New Gallery"]})]}),y.length===0?e.jsxs("div",{className:"bg-slate-800 rounded-lg p-10 text-center",children:[e.jsx("div",{className:"text-5xl mb-4",children:"🖼️"}),e.jsx("h2",{className:"text-xl text-white mb-2",children:"No Galleries Found"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"Create your first gallery to showcase your portfolio."}),e.jsxs("button",{onClick:G,className:"px-6 py-3 bg-yellow-400 text-slate-900 rounded hover:bg-yellow-500 transition-colors",children:[e.jsx(K,{size:18,className:"inline mr-2"}),"Create Gallery"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:y.map(s=>e.jsxs("div",{className:"bg-slate-800 rounded-lg overflow-hidden shadow-md hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"relative h-40",children:[s.cover_image?e.jsx("img",{src:s.cover_image,alt:s.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full bg-slate-700 flex items-center justify-center",children:e.jsx("span",{className:"text-gray-500",children:"No Cover Image"})}),e.jsxs("div",{className:"absolute top-2 right-2 flex space-x-1",children:[s.is_featured&&e.jsx("span",{className:"px-2 py-1 bg-yellow-400/80 text-slate-900 text-xs rounded",children:"Featured"}),!s.is_published&&e.jsx("span",{className:"px-2 py-1 bg-gray-800/80 text-gray-300 text-xs rounded",children:"Draft"})]})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h2",{className:"text-white text-lg font-medium mb-2 truncate",children:s.title}),e.jsx("p",{className:"text-gray-400 text-sm mb-4 line-clamp-2",children:s.description||"No description"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("button",{onClick:()=>k(s),className:"text-yellow-400 flex items-center text-sm hover:text-yellow-300",children:[e.jsx(z,{size:16,className:"mr-1"}),"Settings"]}),e.jsxs("button",{onClick:()=>U(s),className:"text-blue-400 flex items-center text-sm hover:text-blue-300",children:[e.jsx(O,{size:16,className:"mr-1"}),"Manage Media"]})]})]})]},s.id))})]}),h==="edit-gallery"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("button",{type:"button",onClick:()=>{c("galleries"),o(null)},className:"mr-4 text-gray-400 hover:text-white",children:e.jsx(Q,{size:24})}),e.jsx("h1",{className:"text-2xl font-serif text-white",children:t.id?"Edit Gallery":"Create New Gallery"})]}),e.jsxs("form",{onSubmit:q,children:[e.jsxs("div",{className:"bg-slate-800 rounded-lg shadow-lg p-6 mb-8",children:[e.jsx("h2",{className:"text-xl font-medium text-white mb-6",children:"Gallery Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-300 mb-2",children:"Gallery Title*"}),e.jsx("input",{type:"text",name:"title",value:t.title||"",onChange:m,className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded focus:outline-none focus:ring-2 focus:ring-yellow-400 text-white",placeholder:"Gallery Title",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-gray-300 mb-2",children:["Slug*",e.jsx("button",{type:"button",onClick:()=>o({...t,slug:R()}),className:"ml-2 text-xs text-yellow-400 hover:text-yellow-300",children:"Generate from title"})]}),e.jsx("input",{type:"text",name:"slug",value:t.slug||"",onChange:m,className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded focus:outline-none focus:ring-2 focus:ring-yellow-400 text-white",placeholder:"gallery-url-slug",required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-gray-300 mb-2",children:"Description"}),e.jsx("textarea",{name:"description",value:t.description||"",onChange:m,rows:3,className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded focus:outline-none focus:ring-2 focus:ring-yellow-400 text-white",placeholder:"Describe this gallery"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-300 mb-2",children:"Display Order"}),e.jsx("input",{type:"number",name:"display_order",value:t.display_order||0,onChange:m,className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded focus:outline-none focus:ring-2 focus:ring-yellow-400 text-white",min:"0"})]}),e.jsxs("div",{className:"flex items-center space-x-8",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"is_featured",name:"is_featured",checked:t.is_featured||!1,onChange:m,className:"mr-2"}),e.jsx("label",{htmlFor:"is_featured",className:"text-gray-300",children:"Feature on homepage"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"is_published",name:"is_published",checked:t.is_published!==!1,onChange:m,className:"mr-2"}),e.jsx("label",{htmlFor:"is_published",className:"text-gray-300",children:"Published"})]})]})]})]}),e.jsxs("div",{className:"bg-slate-800 rounded-lg shadow-lg p-6 mb-8",children:[e.jsx("h2",{className:"text-xl font-medium text-white mb-6",children:"Cover Image"}),e.jsx("div",{className:"mb-6",children:e.jsx(V,{value:t.cover_image||"",onChange:s=>o({...t,cover_image:s}),onUploadComplete:A,onUploadError:s=>a("error",s.message),folder:"gallery_covers",fileTypes:["image/*"],maxSizeMB:5,placeholder:"Upload a cover image for your gallery",showPreview:!0})})]}),e.jsxs("div",{className:"bg-slate-800 rounded-lg shadow-lg p-6 mb-8",children:[e.jsx("h2",{className:"text-xl font-medium text-white mb-6",children:"SEO Settings"}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-300 mb-2",children:"Meta Title"}),e.jsx("input",{type:"text",name:"meta_title",value:t.meta_title||"",onChange:m,className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded focus:outline-none focus:ring-2 focus:ring-yellow-400 text-white",placeholder:"SEO Title for browser tab and search results"}),e.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:["Recommended length: 50-60 characters. Current length: ",(t.meta_title||"").length]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-300 mb-2",children:"Meta Description"}),e.jsx("textarea",{name:"meta_description",value:t.meta_description||"",onChange:m,rows:3,className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded focus:outline-none focus:ring-2 focus:ring-yellow-400 text-white",placeholder:"Description that appears in search engine results"}),e.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:["Recommended length: 150-160 characters. Current length: ",(t.meta_description||"").length]})]})]})]}),e.jsxs("div",{className:"flex justify-between",children:[t.id&&e.jsxs("button",{type:"button",onClick:()=>w(!0),className:"px-4 py-2 bg-red-500/20 text-red-400 rounded hover:bg-red-500/30 transition-colors",children:[e.jsx(F,{size:18,className:"inline mr-1"}),"Delete Gallery"]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{type:"button",onClick:()=>{c("galleries"),o(null)},className:"px-4 py-2 border border-gray-600 rounded text-gray-300 hover:bg-gray-700 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-6 py-3 bg-yellow-400 text-slate-900 rounded hover:bg-yellow-500 transition-colors flex items-center",disabled:j,children:j?e.jsxs(e.Fragment,{children:[e.jsx(W,{size:18,className:"mr-2 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(X,{size:18,className:"mr-2"}),"Save Gallery"]})})]})]})]})]}),h==="gallery-items"&&t&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("button",{type:"button",onClick:()=>{c("galleries"),o(null),g([])},className:"mr-4 text-gray-400 hover:text-white",children:e.jsx(Z,{size:24})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-serif text-white",children:[t.title," - Media Items"]}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Manage images and videos in this gallery"})]})]}),e.jsxs("div",{className:"bg-slate-800 rounded-lg shadow-lg p-6 mb-8",children:[e.jsx("h2",{className:"text-xl font-medium text-white mb-4",children:"Add New Media"}),e.jsx(B,{onUploadComplete:L,folder:`galleries/${t.id}`,mediaTypes:["image","video"],buttonText:"Select file to upload"})]}),e.jsxs("div",{className:"bg-slate-800 rounded-lg shadow-lg p-6 mb-8",children:[e.jsxs("h2",{className:"text-xl font-medium text-white mb-6",children:["Gallery Media (",u.length,")"]}),u.length===0?e.jsxs("div",{className:"text-center py-10",children:[e.jsx(D,{size:48,className:"mx-auto mb-4 text-gray-500"}),e.jsx("h3",{className:"text-lg text-white mb-2",children:"No Media Items Yet"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"Upload images or add videos to populate this gallery."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:u.map(s=>e.jsxs("div",{className:"bg-slate-700 rounded-md overflow-hidden",children:[e.jsxs("div",{className:"relative h-40",children:[e.jsx("img",{src:s.file_path,alt:s.title||"Gallery media",className:"w-full h-full object-cover"}),s.media_type==="video"&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/30",children:e.jsx(D,{size:32,className:"text-white"})})]}),e.jsxs("div",{className:"p-3",children:[e.jsx("input",{type:"text",value:s.title||"",onChange:l=>N(s.id,{title:l.target.value}),className:"w-full px-2 py-1 mb-2 bg-slate-600 border border-slate-500 rounded focus:outline-none focus:ring-1 focus:ring-yellow-400 text-white text-sm",placeholder:"Title"}),e.jsx("input",{type:"text",value:s.alt_text||"",onChange:l=>N(s.id,{alt_text:l.target.value}),className:"w-full px-2 py-1 mb-2 bg-slate-600 border border-slate-500 rounded focus:outline-none focus:ring-1 focus:ring-yellow-400 text-white text-sm",placeholder:"Alt text for accessibility"}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("button",{type:"button",onClick:()=>N(s.id,{is_featured:!s.is_featured}),className:`p-1 rounded ${s.is_featured?"bg-yellow-400 text-slate-900":"bg-slate-600 text-white"}`,title:s.is_featured?"Featured":"Make featured",children:e.jsx(ee,{size:16})}),e.jsx("button",{type:"button",className:"p-1 rounded bg-slate-600 text-white",title:"Change display order",children:e.jsx(se,{size:16})})]}),e.jsx("button",{type:"button",onClick:()=>T(s.id),className:"p-1 rounded bg-red-500/20 text-red-400 hover:bg-red-500/30",title:"Delete item",children:e.jsx(F,{size:16})})]})]})]},s.id))})]}),e.jsx("div",{className:"flex justify-between",children:e.jsxs("button",{type:"button",onClick:()=>k(t),className:"px-4 py-2 bg-slate-700 text-white rounded hover:bg-slate-600 transition-colors flex items-center",children:[e.jsx(z,{size:18,className:"mr-2"}),"Gallery Settings"]})})]})]})};export{ye as default};
